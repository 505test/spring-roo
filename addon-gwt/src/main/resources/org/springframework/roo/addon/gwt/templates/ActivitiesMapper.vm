#parse ("common.vm")
package $packageName;

import com.google.gwt.app.place.Activity;
import com.google.gwt.app.place.PlaceController;
import com.google.gwt.app.place.ProxyPlace;
#declareImports()

/**
 * Maps {@link ProxyPlace} instances to the {@link Activity} to run.
 */
public class $className {
	private final ${shared.requestFactory} requests;
	private final PlaceController placeController;

	public $className(${shared.requestFactory} requests, PlaceController placeController) {
		this.requests = requests;
		this.placeController = placeController;
	}

	public Activity getActivity(ProxyPlace place) {
		switch (place.getOperation()) {
		case DETAILS:
			return new ${entity.detailsActivity}((${entity.record}) place.getProxy(), 
			    requests, placeController);
			
		case EDIT:
			return new ${entity.editActivity}((${entity.record}) place.getProxy(), 
			    requests, placeController, false);
      
    case CREATE:
      return new ${entity.editActivity}((${entity.record}) place.getProxy(), 
          requests, placeController, true);
		}

		throw new IllegalArgumentException("Unknown operation " + place.getOperation());
	}
}
